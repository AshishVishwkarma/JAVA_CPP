JIL = Job Information Language

NOTE: The job name should be with out hyphen. Only dot is allowed no other special characters.

CA WA Agent vs unixagent vs winagent:




USAGE: autorep [-J JobName] [[-d | -s] [-n | -w] [-R RunNumber] | -o OverRideNumber | -q] [-L PrintLevel] [-t]
               [-I ApplicationName] [-B GroupName] [[-d | -s] [-n | -w] | -o OverRideNumber | -q] [-L PrintLevel] [-t]
               [-G GlobalName] [-n | -w]
               [-M MachineName] [[-d | -s] [-n | -w] | -p | -q]
               [-C ConnectionProfileName] [-q]
               [-V ResourceName] [[-d | -s] [-n | -w] | -q]
               [-X ExternalInstanceName] [[-n | -w] | -q]
               [-Y UserDefinedJobType] [[-n | -w] | -q]
               [-z GlobalBlobName] [[-f BlobDownloadDirectory] [-a] | [-n | -w] | -q]
               [-usr AuthUser [-pw AuthPassword | -pwx AuthEncryptedPassword] | -saml AuthArtifact]
               [-x]
               [-?]

WHERE: -J    JobName
       -I    ApplicationName
       -B    GroupName
       -o    OverRideNumber
       -X    ExternalInstanceName
       -Y    UserDefinedJobType
       -z    GlobalBlobName
       -G    GlobalName
       -M    MachineName
       -C    ConnectionProfileName
       -V    ResourceName
       -d                               Generates a detail report
       -s                               Generates a summary report
       -q                               Generates a query report (Jil format)
       -p                               Generates an agent version, plug-in and advanced integrations report
       -w                               Reports names using the long form (wide)
       -n                               Reports truncated names (narrow)
       -t                               Includes the timezone in the report
       -R    RunNumber                  Generates the report for the job run
                                        specified in run_num
       -L    PrintLevel                 Generated Box Job hierarchy report will be
                                        limited to level specified
       -f    BlobDownloadDirectory      Blob data download location
       -a                               Download blob data to file as ASCII text
       -usr  AuthUser                   User to authenticate with external security
       -pw   AuthPassword               Plain text password for user authentication
       -pwx  AuthEncryptedPassword      Encrypted password for user authentication
       -saml AuthArtifact               Security Assertion Markup Language (SAML) artifact
                                        for single sign-on authentication
       -x                               Returns version information
       -?                               Help

NOTE:  1. -J OR -M OR -G OR -B OR -I OR -X OR -Y OR -V are required parameters.
       2. If OverRideNumber = 0, it will display override number currently in effect.
       3. If both [-B GroupName] and [-I ApplicationName] attributes
          are specified, this is treated as an AND condition.
       4. [-J JobName] and [-B GroupName or -I ApplicationName][-X]
          are mutually exclusive.
       5. The [-a] and/or [-f] attributes are valid with the attribute
          pair [-J JobName] and [-q] or with the [-z GlobalBlobName] attribute














NOTE: ca_l3sb? is not allowed to do autorep on PROD or CONT.


Autosys internally uses Oracle or Sybase database. As long as the data is available in the DB you can fetch it using autorep command. 

As far as troubleshooting batch problems, autosys writes an autoremote log file, and that file is placed where you specify in your setup of autosys. For example, the file might be in the /tmp directory and called auto_rem.389743.93299.1
The file should always start with auto_rem and the numbers that follow will correspond to the job ID in the database.

ON PROD:
-------
sudo su - appdbo
cd /opt/pgti/ixp/etc
. ./lp1.sh
which autorep [for verification] => /opt/pgti/ixp/bin/autorep


ON PREP:
-------
cd /opt/pgti/ixp/etc
. ./gn1.sh
which autorep [for verification] => /opt/pgti/ixp/bin/autorep


To LOOK AT THE STATUS OF THE JOB:
	autorep -J "rsk.sab.dev0.complextradeindia.box.gn1"
	OR
	autorep -J "*.complextradeindia.box.*"
	autorep -J "*.phxvenrtg.box.*"
		
To LOOK AT THE DEFINITION OF THE JOB:
	autorep -J "rsk.sab.dev0.complextradeindia.dslload.gn1" -q
	OR
	autorep -J "*.complextradeindia.dslload.*" -q
	
To print status of only the box (not its individual jobs):
	 autorep -J rsk.sab.prd.mars.cpty.reconcile.box.lp1 -L0
	 
To print value of status only of a job-box:
	 autostatus -J rsk.sab.pre2.mars.cpty.reconcile.box.gn1
	
TO LOOK AT THE PROD JOBS FROM DEV:
sudo su - appdbo
or
sudo su - sabrebat
cd /opt/pgti/ixp/etc
. ./lp1.sh
which autorep [for verification] => /opt/pgti/ixp/bin/autorep

autorep -J "*.phxvenrtg.box.*"
	

	
To LOOK AT RUN DATA:


Detailed Report:
autorep –J jobname –r 0 –d



autorep -J rsk.sab.pre2.kondorftp.reset.gn1 -d
   
   
Job Definition:
 autorep –J jobname –L 0 –q

------------------------------------------------------------------
EVENTS:
	STARTJOB
	KILLJOB
	DELETEJOB
	FORCE_STARTJOB
	JOB_ON_ICE
	JOB_OFF_ICE
	JOB_ON_HOLD
	JOB_OFF_HOLD
	CHANGE_STATUS
	STOP_DEMON
	CHANGE_PRIORITY
	COMMENT
	ALARM
	SET_GLOBAL
	SEND_SIGNAL

sendevent -E KILLJOB -J "Job Name"
sendevent -E FORCE_STARTJOB -J "Job Name"
sendevent -E JOB_ON_ICE -J "Job Name"
sendevent -E JOB_OFF_ICE -J "Job Name"
sendevent -E JOB_ON_HOLD -J "Job Name"
sendevent -E JOB_OFF_HOLD -J "Job Name"

example:
sendevent -E CHANGE_STATUS -s INACTIVE -J rsk.sab.pre3.gterepo.box.gn1
=> Puts only the box-job in inactive state. Internal jobs remain ON HOLD.
NOTE: for sendevent "Job Name" must be complete job name (it does not work with partial job name,e.g., %.pre3.gterepo.box.%).
------------------------------------------------------------------
sendevent -E FORCE_STARTJOB -J rsk.sab.dev0.g?preterm.gn1
Exception in thread "main" com.pgti.ixp.core.exception.IxpException: Job '"rsk.sab.dev0.g?preterm.gn1"' not found.
        at com.pgti.ixp.core.group.UGUtil.hasJobAccess(UGUtil.java:312)
        at com.pgti.ixp.core.group.UGUtil.validateSendevent(UGUtil.java:612)
        at com.pgti.ixp.core.IxCmd.ixSendevent(IxCmd.java:542)
        at sun.reflect.GeneratedMethodAccessor1066.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at com.pgti.ixp.core.util.StaticInvocation.invoke(StaticInvocation.java:267)
        at com.pgti.ixp.core.util.StaticInvocation.process(StaticInvocation.java:704)
        at com.pgti.ixp.core.servlet.Client.doPostX(Client.java:244)
        at com.pgti.ixp.core.servlet.Client.doPost(Client.java:129)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)
        at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:602)
        at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
        at java.lang.Thread.run(Thread.java:662)

------------------------------------------------------------------
Following are the status of Autosys jobs:

INACTIVE : The job has not yet been processed. Either the job has never been run, or its status was intentionally altered to “turn off” its previous completion status.
ACTIVATED :The top-level box that this job is in is now in the RUNNING state, but the job itself has not started yet.
STARTING : The event processor has initiated the start job procedure with the Remote Agent.
RUNNING : The job is running. If the job is a box job, this value simply means that the jobs within the box may be started (other conditions permitting). If it is a command or file watcher job, the value means that the process is actually running on the remote machine.
SUCCESS : The job exited with an exit code equal to or less than the “maximum exit code for success.” By default, only the exit code “0” is interpreted as “success.” If the job is a box job, this value means that all the jobs within the box have finished with the status SUCCESS (the default), or the “Exit Condition for Box Success” evaluated to true
FAILURE : The job exited with an exit code greater than the “maximum exit code for success.” By default, any number greater than zero is interpreted as “failure.” AutoSys issues an alarm if a job fails
TERMINATED : The job terminated while in the RUNNING state. A job can be terminated if a user sends a KILLJOB event or if it was defined to terminate if the box it is in failed. If the job itself fails, it has a FAILURE status, not a TERMINATED status. A job may also be terminated if it has exceeded the maximum run time (term_run_time attribute, if one was specified for the job), or if it was killed from the command line through a UNIX kill command. AutoSys issues an alarm if a job is terminated.
RESTART : The job was unable to start due to hardware or application problems, and has been scheduled to restart.
QUE_WAIT : The job can logically run (that is, all the starting conditions have been met), but there are not enough machine resources available.
ON_HOLD : This job is on hold and will not be run until it receives the JOB_OFF_HOLD event.
ON_ICE : This job is removed from all conditions and logic, but is still defined to AutoSys. Operationally, this condition is like deactivating the job. It will remain on ice until it receives the JOB_OFF_ICE event. 
------------------------------------------------------------------
Difference between ON ICE & ON HOLD jobs:
The difference between "on hold" and "on ice" is that when an "on hold" job is taken off hold, if its starting conditions are already satisfied, it will be scheduled to run, and it will run. On the other hand, if an "on ice" job is taken "off ice," it will not start, even if its starting conditions are already satisfied. This job will not run until its starting conditions reoccur.

The other major distinction is that jobs downstream from the job that is "on ice" will run as though the job succeeded. Whereas, all dependent jobs do not run when a job is on "on hold"—nothing downstream from this job will run.

If an internal job in the job-box is ON HOLD, the job-box keeps running. While if the internal job in the job-box is ON ICE. the job-box gets completed successfully.
------------------------------------------------------------------
Box Job:
A box is a container of jobs with similar starting conditions (date and time conditions or job dependency conditions). Use boxes to group jobs with similar scheduling parameters, not to group jobs organizationally.

Default Box Job Behavior:
The following default rules apply to boxes:
- Jobs in a box run only once for each box execution.
- Jobs in a box start only if the box itself has a status of RUNNING.
- Boxes are used primarily for jobs with the same starting conditions.
- A box that is used to group sequential jobs can contain up to 1,000 jobs.
- A box remains in RUNNING state until all the jobs it contains have run.
- A box returns a status of SUCCESS when all the jobs it contains have run and returned a status of SUCCESS.
- A box returns a status of FAILURE when all the jobs it contains have run and one or more of the jobs has returned a status of FAILURE.
- A box runs until it reaches a status of SUCCESS or FAILURE.
- Using the sendevent command to change the state of a box to INACTIVE changes the state of all the jobs it contains to INACTIVE.
- Using the sendevent command to change the state of a job in a box to INACTIVE affects the box’s completion status as if the INACTIVE job returned a status of SUCCESS.


------------------------------------------------------------------
To update an existing box or job definition in the database:

update_job: job_name 
attribute:value

The update_job subcommand updates an existing box or job definition in the database. The update_job statement is followed by a list of attribute:value statements.
Attributes in the existing definition that are not explicitly replaced in the update_job input retain their original settings.
Note: When many attributes must be updated for a job, it may be more efficient to delete and re-insert the job definitions.

Example:
SOP1372.jil:

description: "SCCSID: @(#)$Id: SOP1372.jil,v 1.3 2014/06/25 04:32:47 prasadm Exp $"
update_job: rsk.sab.$AS_ENV.marut.$AS_INSTANCE   job_type: CMD
envvars: $AS_PWD
update_box: rsk.sab.$AS_ENV.df.txt.box.$AS_INSTANCE 
envvars: $AS_PWD

SOP-2055, SOP-2169
--------------------------------------------------------------------------------------------
description: "Change watch_interval from 6 to 120 @(#)$Id: rsk.sab.iceln.box.SOP-2055.jil,v 1.2 2017/05/09 05:15:20 vishwaf Exp $"
update_job: rsk.sab.$AS_ENV.iceln.chkconpirdatafile.$AS_INSTANCE   job_type: f
watch_interval: 120

update_job: rsk.sab.$AS_ENV.iceln.chkconpirdatasem.$AS_INSTANCE   job_type: f
watch_interval: 120
---------------------------------------------------------------------
Autosys log path: /opt/CA/WA_AGENT/log

WAAE.txt File:
The WAAE.txt file defines the environment settings for jobs that are started on behalf of all managers for all instances of. You can define the environment variables on a single line as a variable=value pair. The jobs that the agent runs inherit these environment variables.
Note: The WAAE.txt file applies to the CA Workload Automation Agent for UNIX, Linux, or Windows.
The WAAE.txt file is located in the following directory:
	Windows -- %AUTOROOT%\SystemAgent\agent_name\Profiles
	UNIX -- $AUTOROOT/SystemAgent/agent_name/profiles

Agent-wide environment variables and Manager-wide environment variables:

agent-wide, manager-specific, or user-specific environment variables:
---------------------------------------------------------------------
CA WAAE Calendar Utility:
	autocal_asc
	The autocal_asc command is a client component utility that provides a text-based command line mechanism for adding, deleting, printing, exporting, and importing calendars.
	CA Workload Automation AE uses calendars to schedule the days on which jobs should run. Each calendar has a unique name and contains a list of days on which the jobs may run or are excluded from running.
	When you update a calendar, CA Workload Automation AE recalculates the starting times for all jobs that use the updated calendar.
	Note: You must regenerate an extended calender to reflect the changes made.
	
	autocal_asc -e BSS.ALL.01ST.DAY.OF.MONTH -E ecalander.txt
---------------------------------------------------------------------
rsk.sab.fxrates.onshore.box.jil:
exclude_calendar: BSS.LON.PUBLIC.HOLIDAYS   
---------------------------------------------------------------------
rsk.sab.pre2.syntradesreport.gn1
run_calendar: BSS.ALL.01ST.DAY.OF.MONTH
-----------------------------------------
extended_calendar: BSS.ALL.01ST.DAY.OF.MONTH
workday: mo,tu,we,th,fr
non_workday: 
holiday: 
holcal: 
cyccal: 
adjust: 0
condition: MNTHD#01
description: 
---------------------------------------------------------------------
NOTE:
Internal jobs could run even though the box is in terminated state.
Inactive jobs are not running. Other jobs dependent on it, can go for run.
Putting Internal jobs OFF ICE after the box has started keeps the Internal jobs Inactive in the current run. The Internal jobs run in the next run of the box.

Jobs ON ICE or RUNNING does not go ON HOLD.
